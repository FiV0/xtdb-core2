hash-threshold 100

statement ok
INSERT INTO t1(xt$id) VALUES(1)

statement ok
INSERT INTO t2(xt$id) VALUES(2)

query ITT nosort
SELECT t1.xt$id FROM t1
----
1

query II nosort
SELECT t1.xt$id, (SELECT t2.xt$id FROM t2 FOR SYSTEM_TIME BETWEEN DATE '2000-01-01' AND DATE '3000-01-01') FROM t1
----
1
2

query II nosort
SELECT t1.xt$id, (SELECT t2.xt$id FROM t2 FOR SYSTEM_TIME BETWEEN DATE '2000-01-01' AND DATE '2010-01-01') FROM t1
----
1
NULL

query II nosort
SELECT t1.xt$id, (SELECT t2.xt$id FROM t2 FOR SYSTEM_TIME BETWEEN DATE '2000-01-01' AND DATE '2010-01-01') FROM t1 FOR SYSTEM_TIME AS OF DATE '2100-01-01'
----
1
NULL

query II nosort
SELECT t1.xt$id, (SELECT t2.xt$id FROM t2 FOR SYSTEM_TIME BETWEEN DATE '2000-01-01' AND DATE '2010-01-01') FROM t1 FOR SYSTEM_TIME AS OF DATE '2000-01-01'
----
